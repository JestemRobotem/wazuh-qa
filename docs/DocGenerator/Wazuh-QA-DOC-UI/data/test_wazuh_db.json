{
    "brief": "Module description",
    "metadata": {
        "modules": [
            "Wazuh DB"
        ],
        "daemons": [
            "wazuh_db"
        ],
        "operating_system": [
            "Windows",
            "Ubuntu"
        ],
        "tiers": [
            0,
            1
        ],
        "tags": [
            "Enrollment"
        ]
    },
    "name": "test_wazuh_db.py",
    "id": 1,
    "group_id": 2,
    "tests": [
        {
            "test_logic": "Check that every input message in wazuh-db socket generates the adequate output to wazuh-db socket",
            "name": "test_wazuh_db_messages",
            "test_cases": [
                "global: Insert commands",
                "global: Update commands",
                "global: Labels commands",
                "global: Select commands",
                "global: get-all-agents command",
                "global: sync-agent-info-get command",
                "global: sync-agent-info-set command",
                "global: Belongs commands",
                "global: Reset connection status",
                "global: get-agents-by-connection-status command",
                "global: disconnect-agents command",
                "global: Delete commands",
                "global: Manager keepalive",
                "fim: Basics success",
                "fim: Syntax errors",
                "fim: Save2 fails",
                "fim: Integrity_check_global success",
                "fim: Integrity_check_global fails",
                "fim: Integrity_check_left success",
                "fim: Integrity_check_left fails",
                "fim: Integrity clear success",
                "fim: Integrity_clear fails",
                "fim: Invalid agent ID",
                "fim: Update existing file",
                "fim: Path length",
                "fim: checksum field",
                "fim: Large inode",
                "agent: Agents' CVEs table: vuln_cves"
            ]
        },
        {
            "test_logic": "Check that Wazuh DB creates the agent database when a query with a new agent ID is sent. Also...\nBut also...",
            "checks": [
                "The received output must match with...",
                "The received output with regex must match with..."
            ],
            "name": "test_wazuh_db_create_agent"
        }
    ]
}
