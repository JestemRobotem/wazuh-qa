<!--
  Wazuh - Agent - Default configuration.
  More info at: https://documentation.wazuh.com
  Mailing list: https://groups.google.com/forum/#!forum/wazuh
-->

<ossec_config>
  <!-- agentless tag does not trigger unsupported on agent -->
  <!-- alerts tag does not trigger unsupported on agent -->
  <!-- auth tag does not trigger unsupported on agent -->
  <auth>
    <disabled>no</disabled>
  </auth>

  <client>
    <server>
      <!-- content is not checked -->
      <address>asxasx</address>
      <port>65535</port>
      <protocol>udp</protocol>
    </server>
    <!-- <server-ip>127.0.0.1</server-ip> -->
    <!-- <server-hostname></server-hostname> -->
    <!-- <port>1</port> -->
    <!-- <protocol>udp</protocol> -->
    <config-profile></config-profile>
    <!-- 0 is allowed -->
    <notify_time>13513251</notify_time>
    <!-- 0 is allowed -->
    <time-reconnect>13513215</time-reconnect>
    <local_ip>192.168.50.11</local_ip>
    <!-- deprecated tag is not warned -->
    <disable-active-response>no</disable-active-response>
    <auto_restart>yes</auto_restart>
    <crypto_method>aes</crypto_method>
  </client>

  <!-- Empty tag is not warned -->
  <client_buffer>
    <disabled>no</disabled>
    <!-- deprecated tag is not warned -->
    <!-- <disable>no</disable> -->
    <queue_size>100000</queue_size>
    <!-- deprecated tag is not warned -->
    <!-- <length>1</length> -->
    <events_per_second>1000</events_per_second>
  </client_buffer>

  <!-- cluster tag does not trigger unsupported on agent -->
  <cluster>
    <name>wazuh</name>
  </cluster>

  <!-- command tag does not trigger unsupported on agent -->
  <command>
    <name>custom_command</name>
    <executable>custom_script.sh</executable>
  </command>

  <!-- database_output tag does not trigger unsupported on agent -->
  <database_output>
    <hostname>192.168.1.122</hostname>
    <username>MySQLadmin</username>
    <password>secret1234</password>
    <database>Alerts_DB</database>
    <type>mysql</type>
  </database_output>

  <!-- email_alerts tag does not trigger unsupported on agent -->
  <email_alerts>
    <email_to>recipient@example.wazuh.com</email_to>
    <email_to>recipient2@example.wazuh.com</email_to>
    <level>12</level>
    <group>sshd,</group>
    <do_not_delay/>
  </email_alerts>

  <!-- global tag does not trigger unsupported on agent -->
  <global>
    <jsonout_output>yes</jsonout_output>
    <alerts_log>yes</alerts_log>
    <logall>no</logall>
    <logall_json>no</logall_json>
    <email_notification>yes</email_notification>
    <smtp_server>smtp.example.wazuh.com</smtp_server>
    <email_from>ossecm@example.wazuh.com</email_from>
    <email_to>recipient@example.wazuh.com</email_to>
    <email_maxperhour>12</email_maxperhour>
  </global>

  <!-- Integration with Slack -->
  <!-- integraction tag does not trigger unsupported on agent -->
  <integration>
    <name>slack</name>
    <hook_url>https://hooks.slack.com/services/...</hook_url>    <!-- Replace with your Slack hook URL -->
    <level>10</level>
    <group>multiple_drops|authentication_failures</group>
    <alert_format>json</alert_format>
  </integration>

  <labels>
    <label key="516151" hidden="yes">csjdn</label>
  </labels>

  <localfile>
    <location>csdkjnsln</location>
    <log_format>eventchannel</log_format>
    <command>csdjcnsjldn</command>
    <alias></alias>
    <frequency>0</frequency>
    <only-future-events>no</only-future-events>
    <query>cskdnskjdn</query>
    <label key="@test"></label>
    <target>sclskdm</target>
    <out_format></out_format>
    <ignore_binaries>no</ignore_binaries>
    <age>1w</age>
    <exclude>caksjdn</exclude>
  </localfile>

  <logging>
    <log_format>plain</log_format>
  </logging>

  <!-- remote tag does not trigger unsupported on agent -->
  <remote>
    <connection>syslog</connection>
    <port>514</port>
    <protocol>udp</protocol>
    <allowed-ips>192.168.1.0/24</allowed-ips>
    <local_ip>192.168.1.5</local_ip>
  </remote>

  <!-- reports tag does not trigger unsupported on agent -->
  <reports>
    <title>Auth_Report</title>
    <group>authentication_failed,</group>
    <srcip>192.168.1.10</srcip>
    <email_to>recipient@example.wazuh.com</email_to>
    <showlogs>yes</showlogs>
  </reports>

  <!-- Allowed to be empty -->
  <rootcheck>
    <!-- unchecked -->
    <base_directory>csldjnskj</base_directory>
    <!-- unchecked -->
    <ignore>casdlkn</ignore>
    <!-- unchecked -->
    <rootkit_files>csldknlscksnd</rootkit_files>
    <!-- unchecked -->
    <rootkit_trojans>csjdnkjnbur</rootkit_trojans>
    <!-- unchecked -->
    <windows_audit>cdslknsdbg</windows_audit>
    <!-- unchecked -->
    <system_audit>csdk1jbskdj</system_audit>
    <!-- unchecked -->
    <windows_apps>vkdjfnvkdjbe</windows_apps>
    <!-- unchecked -->
    <windows_malware>gauenjkvdfk</windows_malware>
    <scanall>yes</scanall>
    <frequency>1235498</frequency>
    <disabled>no</disabled>
    <check_dev>yes</check_dev>
    <check_files>yes</check_files>
    <check_if>yes</check_if>
    <check_pids>yes</check_pids>
    <check_sys>yes</check_sys>
    <check_trojans>yes</check_trojans>
    <check_unixaudit>yes</check_unixaudit>
    <!-- unchecked -->
    <check_winapps>calsjnc</check_winapps>
    <!-- unchecked -->
    <check_winaudit>scldkn</check_winaudit>
    <!-- unchecked -->
    <check_winmalware>clskdn</check_winmalware>
    <skip_nfs>yes</skip_nfs>
  </rootcheck>

  <!-- Allowed to be empty -->
  <sca>
    <enabled>yes</enabled>
    <skip_nfs>yes</skip_nfs>
    <policies>
      <policy>/var/ossec/credentials.json</policy>
    </policies>
    <scan_on_start>yes</scan_on_start>
    <!-- Does not check for negative numbers -->
    <interval>4w</interval>
    <!-- <day>31</day> -->
    <wday>sun</wday>
    <time>1:00</time>
  </sca>

  <ruleset>
    <rule_include>ruleset/rules/my_rules.xml</rule_include>
    <rule_dir pattern="_rules.xml$">ruleset/rules</rule_dir>
    <rule_exclude>0215-policy_rules.xml</rule_exclude>
    <decoder_include>ruleset/decoders/my_decoder.xml</decoder_include>
    <decoder_dir pattern=".xml$">ruleset/decoders</decoder_dir>
    <decoder_exclude>ruleset/decoders/my_decoder.xml</decoder_exclude>
    <list>etc/lists/blocked_hosts</list>
  </ruleset>

  <socket>
    <name>test-socket</name>
    <location>lsdkn</location>
    <mode>udp</mode>
    <prefix>csdkjncsld: </prefix>
  </socket>

  <syscheck>
    <disabled>no</disabled>
    <directories realtime="yes" whodata="yes" report_changes="yes" check_all="yes" check_sha1sum="yes" restrict="" recursion_level="320" follow_symbolic_link="no">/var, /etc</directories>
    <ignore type="sregex">csdc</ignore>
    <nodiff type="sregex">sdcsdc</nodiff>
    <frequency>5132</frequency>
    <scan_time>0:99</scan_time>
    <scan_day>monday, thursday</scan_day>
    <!-- unsupported configuration for agent not warned -->
    <!-- <auto_ignore frequency="11111111" timeframe="12312154">yes</auto_ignore> -->
    <!-- unsupported configuration for agent not warned -->
    <!-- <alert_new_files>yes</alert_new_files> -->
    <scan_on_start>yes</scan_on_start>
    <windows_registry arch="both" tags="csdnj, cksjdnk"></windows_registry>
    <registry_ignore arch="acsjanscj" tags="cljskndckjsnd"></registry_ignore>
    <skip_nfs>yes</skip_nfs>
    <remove_old_diff>yes</remove_old_diff>
    <restart_audit>yes</restart_audit>
    <windows_audit_interval>1234578</windows_audit_interval>

    <whodata>
      <restart_audit>yes</restart_audit>
      <audit_key></audit_key>
      <startup_healthcheck>no</startup_healthcheck>
    </whodata>
  </syscheck>

  <syslog_output>
    <server>192.168.1.3</server>
    <level>7</level>
    <format>json</format>
  </syslog_output>

  <wodle name="open-scap">
    <disabled>yes</disabled>
    <timeout>123456788</timeout>
    <interval>123455687</interval>
    <scan-on-start>yes</scan-on-start>
    <content path="" type="xccdf">
      <timeout>123456</timeout>
      <!-- <datastream-id>cskjdncksjd</datastream-id> -->
      <!-- <oval-id>csdlkn</oval-id> -->
      <xccdf-id>csldkncsk</xccdf-id>
      <cpe>cslkdm</cpe>
      <profile>csljdn</profile>
    </content>
  </wodle>

  <wodle name="command">
    <disabled>yes</disabled>
    <tag>A description</tag>
    <command>ls -la</command>
    <interval>-1234568</interval>
    <run_on_start>yes</run_on_start>
    <ignore_output>yes</ignore_output>
    <timeout>0</timeout>
    <verify_md5>5Hada3704685dad6fd27beb58e6687de</verify_md5>
    <verify_sha1>daH9a3ee5e6b4b0d3255bfef95601890afd80709</verify_sha1>
    <verify_sha256>292aa88e498caea5c5fbfb0beca413c980e7a5edf40d47cf70e1dbc33e4f395e</verify_sha256>
    <skip_verification>yes</skip_verification>
  </wodle>

  <wodle name="cis-cat">
    <disabled>no</disabled>
    <timeout>123456</timeout>
    <java_path>sdjcnskjdcn</java_path>
    <ciscat_path>csldcnlsa√±</ciscat_path>

    <content type="xccdf" path="clskdclsk">
      <timeout>123123</timeout>
      <profile>xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Server</profile>
    </content>

    <scan-on-start>yes</scan-on-start>
    <!-- interval is allowed to be negative in the agent -->
    <interval>2w</interval>
    <!-- <day>25</day> -->
    <wday>suncslkdnls</wday>
    <time>13:59</time>
  </wodle>

  <wodle name="syscollector">
    <disabled>yes</disabled>
    <interval>-11</interval>
    <scan_on_start>yes</scan_on_start>
    <hardware>yes</hardware>
    <os>yes</os>
    <network>yes</network>
    <packages>yes</packages>
    <ports all="yes">yes</ports>
    <processes>yes</processes>
  </wodle>

  <wodle name="osquery">
    <disabled>yes</disabled>
    <run_daemon>yes</run_daemon>
    <bin_path>csjdncks</bin_path>
    <log_path>cksjdncks</log_path>
    <config_path>sldncsjku</config_path>
    <add_labels>yes</add_labels>
    <pack name="cslkdn"></pack>
  </wodle>

  <wodle name="docker-listener">
    <interval>123w</interval>
    <attempts>123456</attempts>
    <run_on_start>yes</run_on_start>
    <disabled>yes</disabled>
  </wodle>

  <fluent-forward>
    <enabled>yes</enabled>
    <socket_path>cksjdn</socket_path>
    <tag>csldkn</tag>
    <address>192.168.50.10</address>
    <port>65534</port>
    <shared_key>caksjdnuhr</shared_key>
    <ca_file>cskdjn</ca_file>
    <user>cskjdn</user>
    <password>sckdjnuwe</password>
    <timeout>9000</timeout>
  </fluent-forward>

</ossec_config>
