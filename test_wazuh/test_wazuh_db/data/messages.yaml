---
# Check success use cases (save2, load and delete)
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "ok"
  type: "Syscheck save2 success"
-
  input: "agent 001 syscheck load /home/test/file2"
  output: "ok 0:rw-r--r--:0:0:d41d8cd98f00b204e9800998ecf8427e:da39a3ee5e6b4b0d3255bfef95601890afd80709:root:root:1575421292:16879:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855:!1:1575421292"
  type: "Syscheck save2 load success"
-
  input: "agent 001 syscheck load /home/test/file"
  output: "ok "
  type: "Syscheck save2 load success"
-
  input: "agent 001 syscheck delete /home/test/file2"
  output: "ok"
  type: "Syscheck delete success"
-
  input: "agent 001 syscheck load /home/test/file2"
  output: "ok "
  type: "Syscheck save2 load success"
# Invalid syntax errors (save2, load and delete)
-
  input: "agent 002 syscheck delete"
  output: "err Invalid FIM query syntax, near 'delete'"
  type: "Syscheck delete invalid syntax"
-
  input: "agent 002 syscheck save2"
  output: "err Invalid FIM query syntax, near 'save2'"
  type: "Syscheck save2 invalid syntax"
-
  input: "agent 002 syscheck load"
  output: "err Invalid FIM query syntax, near 'load'"
  type: "Syscheck load invalid syntax"
# Check save2 fail use cases
-
  input: "agent 002 syscheck save2 {\"path\":\"/home/test/file2\"\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "err Cannot save Syscheck"
  type: "Syscheck save2 fail: Bad JSON"
-
  input: "agent 002 syscheck save2 {\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "err Cannot save Syscheck"
  type: "Syscheck save2 fail: no path"
-
  input: "agent 002 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":\"asdf\",\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "err Cannot save Syscheck"
  type: "Syscheck save2 fail: Bad (or no) timestamp"
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":1575421292}"
  output: "err Cannot save Syscheck"
  type: "Syscheck save2 fail: No attributes"
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":1575421292,\"attributes\":{\"\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "err Cannot save Syscheck"
  type: "Syscheck save2 fail: Null attribute field (sqlite3_step fail)"
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":1575421292,\"attributes\":{\"file\":null,\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "err Cannot save Syscheck"
  type: "Syscheck save2 fail: Null attribute value (sqlite3_step fail and reset)"
# Check non-expected field in attributes object
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "ok"
  type: "Syscheck save2 success: unknown attribute field"
# Create the needed entries
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file1\",\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "ok"
  type: "Syscheck save2 success"
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "ok"
  type: "Syscheck save2 success"
# Integrity check global
-
  input: "agent 001 syscheck integrity_check_global {\"begin\":\"/home/test/file1\",\"end\":\"/home/test/file2\",\"checksum\":\"2a41be94762b4dc57d98e8262e85f0b90917d6be\",\"id\":1}"
  output: "ok "
  type: "Syscheck integrity_check_global success"
-
  input: "agent 001 syscheck integrity_check_global {\"begin\":\"/home/test/file1\",\"end\":\"/home/test/file2\",\"checksum\":\"asdf1234\",\"id\":1}"
  output: "ok checksum_fail"
  type: "Syscheck integrity_check_global fail - checksum_fail"
-
  input: "agent 001 syscheck integrity_check_global"
  output: "err Invalid FIM query syntax, near 'integrity_check_global'"
  type: "Syscheck integrity_check_global fail - invalid syntax"
-
  input: "agent 001 syscheck integrity_check_global {\"begin\":\"/home/test/f1\",\"end\":\"/home/test/f2\",\"checksum\":\"1234\",\"id\":1}"
  output: "ok no_data"
  type: "Syscheck integrity_check_global success - no data"
-
  input: "agent 001 syscheck integrity_check_global "
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_global fail - no payload"
-
  input: "agent 001 syscheck integrity_check_global {\"end\":\"/home/test/f2\",\"checksum\":\"1234\",\"id\":1}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_global - no 'begin' field"
-
  input: "agent 001 syscheck integrity_check_global {\"begin\":\"/home/test/f1\",\"checksum\":\"1234\",\"id\":1}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_global - no 'end' field"
-
  input: "agent 001 syscheck integrity_check_global {\"begin\":\"/home/test/f1\",\"end\":\"/home/test/f2\",\"id\":1}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_global - no 'checksum' field"
-
  input: "agent 001 syscheck integrity_check_global {\"begin\":\"/home/test/f1\",\"end\":\"/home/test/f2\",\"checksum\":\"1234\"}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_global - no 'id' field"
# Check the database has been erased after check_integrity global
-
  input: "agent 001 syscheck integrity_check_global {\"begin\":\"/home/test/file1\",\"end\":\"/home/test/file2\",\"checksum\":\"2a41be94762b4dc57d98e8262e85f0b90917d6be\",\"id\":1}"
  output: "ok no_data"
  type: "Syscheck integrity_check_global success - no data"
# Check the non-existent file wasn't put into the database
-
  input: "agent 001 syscheck load /home/test/f1"
  output: "ok "
  type: "Syscheck save2 load success"
#  Integrity check left
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file1\",\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "ok"
  type: "Syscheck save2 success"
-
  input: "agent 001 syscheck save2 {\"path\":\"/home/test/file2\",\"timestamp\":1575421292,\"attributes\":{\"type\":\"file\",\"size\":0,\"perm\":\"rw-r--r--\",\"uid\":\"0\",\"gid\":\"0\",\"user_name\":\"root\",\"group_name\":\"root\",\"inode\":16879,\"mtime\":1575421292,\"hash_md5\":\"d41d8cd98f00b204e9800998ecf8427e\",\"hash_sha1\":\"da39a3ee5e6b4b0d3255bfef95601890afd80709\",\"hash_sha256\":\"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\"checksum\":\"f65b9f66c5ef257a7566b98e862732640d502b6f\"}}"
  output: "ok"
  type: "Syscheck save2 success"
-
  input: "agent 001 syscheck integrity_check_left {\"begin\":\"/home/test/file1\",\"end\":\"/home/test/file2\",\"checksum\":\"2a41be94762b4dc57d98e8262e85f0b90917d6be\",\"id\":1}"
  output: "ok "
  type: "Syscheck integrity_check_left success - no tail"
-
  input: "agent 001 syscheck integrity_check_left {\"begin\":\"/home/test/file1\",\"end\":\"/home/test/file2\",\"checksum\":\"2a41be94762b4dc57d98e8262e85f0b90917d6be\",\"id\":1,\"tail\":3}"
  output: "ok "
  type: "Syscheck integrity_check_left success - tail"
-
  input: "agent 001 syscheck integrity_check_left {\"begin\":\"/home/test/file1\",\"end\":\"/home/test/file2\",\"checksum\":\"asdf1234\",\"id\":1}"
  output: "ok checksum_fail"
  type: "Syscheck integrity_check_left fail - checksum_fail"
-
  input: "agent 001 syscheck integrity_check_left"
  output: "err Invalid FIM query syntax, near 'integrity_check_left'"
  type: "Syscheck integrity_check_left fail - invalid syntax"
-
  input: "agent 001 syscheck integrity_check_left {\"begin\":\"/home/test/f1\",\"end\":\"/home/test/f2\",\"checksum\":\"1234\",\"id\":1}"
  output: "ok no_data"
  type: "Syscheck integrity_check_left success - no data"
-
  input: "agent 001 syscheck integrity_check_left "
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_left fail - no payload"
-
  input: "agent 001 syscheck integrity_check_left {\"end\":\"/home/test/f2\",\"checksum\":\"1234\",\"id\":1}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_left - no 'begin' field"
-
  input: "agent 001 syscheck integrity_check_left {\"begin\":\"/home/test/f1\",\"checksum\":\"1234\",\"id\":1}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_left - no 'end' field"
-
  input: "agent 001 syscheck integrity_check_left {\"begin\":\"/home/test/f1\",\"end\":\"/home/test/f2\",\"id\":1}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_left - no 'checksum' field"
-
  input: "agent 001 syscheck integrity_check_left {\"begin\":\"/home/test/f1\",\"end\":\"/home/test/f2\",\"checksum\":\"1234\"}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_check_left - no 'id' field"
  # Integrity clear
-
  input: "agent 001 syscheck integrity_clear {\"id\":1}"
  output: "ok "
  type: "Syscheck integrity_clear success"
-
  input: "agent 001 syscheck integrity_clear"
  output: "err Invalid FIM query syntax, near 'integrity_clear'"
  type: "Syscheck integrity_clear fail - invalid syntax"
-
  input: "agent 001 syscheck integrity_clear "
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_clear fail - no payload"
-
  input: "agent 001 syscheck integrity_clear {}"
  output: "err Cannot perform range checksum"
  type: "Syscheck integrity_clear fail - no id"
  
