# Need to be splitted and create more tests and Tcases(logs that will fail, more format logs, etc.)
- name: Verify AWS logs
  description: Verify that the engine accepts AWS sample logs
  configuration_parameters:
    cfg: TODO
  metadata:
    events:
      - 192.128.0.1 - - [26/Dec/2016:16:16:29 +0200] "GET /favicon.ico HTTP/1.1" 404 209
      - 192.128.0.1 - - [26/Dec/2016:16:16:29 +0200] "POST /favicon.ico HTTP/1.1" 404 209
      - 2019-11-27 15:09:34,491 | INFO  | KahaDB is version 6 | org.apache.activemq.store.wawa.MessageDatabase | main
      - 2019-11-27 15:09:34,531 | INFO  | PListStore:[/opt/activemq/data/localhost/tmp_storage] started | org.apache.activemq.store.wawa.plist.PListStoreImpl | main
      - 2019-11-27 15:09:34,690 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is starting | org.apache.activemq.broker.BrokerService | main
      - 2019-11-27 15:09:34,712 | ERROR | Failed to start Apache ActiveMQ (localhost, ID:5323986a6080-37033-1572227374550-0:1) | org.apache.activemq.broker.BrokerService | main at org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:28)[activemq-client-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:2264)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.startTransportConnector(BrokerService.java:2744)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.startAllConnectors(BrokerService.java:2640)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.doStartBroker(BrokerService.java:771)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.startBroker(BrokerService.java:733)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.broker.BrokerService.start(BrokerService.java:636)[activemq-broker-5.15.9.jar:5.15.9] at org.apache.activemq.xbean.XBeanBrokerService.afterPropertiesSet(XBeanBrokerService.java:73)[activemq-spring-5.15.9.jar:5.15.9] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.8.0_212] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)[:1.8.0_212] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)[:1.8.0_212] at java.lang.reflect.Method.invoke(Method.java:498)[:1.8.0_212] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1763)[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE] at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1700)[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE]
      - 2019-11-27 15:09:34,716 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is shutting down | org.apache.activemq.broker.BrokerService | main
      - 2019-11-27 15:09:34,718 | INFO  | Connector openwire stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,719 | INFO  | Connector amqp stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,721 | INFO  | Connector stomp stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,722 | INFO  | Connector mqtt stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,723 | INFO  | Connector ws stopped | org.apache.activemq.broker.TransportConnector | main
      - 2019-11-27 15:09:34,727 | INFO  | PListStore:[/opt/activemq/data/localhost/tmp_storage] stopped | org.apache.activemq.store.wawa.plist.PListStoreImpl | main
      - 2019-11-27 15:09:34,728 | INFO  | Stopping async queue tasks | org.apache.activemq.store.wawa.KahaDBStore | main
      - 2019-11-27 15:09:34,730 | INFO  | Stopping async topic tasks | org.apache.activemq.store.wawa.KahaDBStore | main
      - 2019-11-29 10:59:49,515 | INFO  | No Spring WebApplicationInitializer types detected on classpath | /admin | main
      - 2019-11-29 10:59:49,779 | INFO  | Initializing Spring FrameworkServlet \'dispatcher\' | /admin | main
      - INFO  | anonymous called org.apache.activemq.broker.jmx.QueueView.retryMessages[] at 27-11-2019 08:45:57,213 | qtp443290224-47
      - INFO  | admin called org.apache.activemq.broker.jmx.QueueView.retryMessages[] at 27-11-2019 08:45:57,229 | qtp443290224-45
      - WARN  | admin requested /admin/createDestination.action [JMSDestination=\'test\' JMSDestinationType=\'queue\' secret=\'4eb0bc3e-9d7a-4256-844c-24f40fda98f1\' ] from 127.0.0.1 | qtp12205619-39
      - INFO  | guest requested /admin/purgeDestination.action [JMSDestination=\'test\' JMSDestinationType=\'queue\' secret=\'eff6a932-1b58-45da-a64a-1b30b246cfc9\' ] from 127.0.0.1 | qtp12205619-36
    engine_outputs:
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"192\.128\.0\.1 - - \[26\/Dec\/2016:16:16:29 \+0200\] \\\\"GET \/favicon\.ico HTTP\/1\.1\\\\" 404 209","kind":"event","dataset":"apache\.access","category":\["web"\],"module":"apache","outcome":"failure"},"http":{"response":{"status_code":404,"body":{"bytes":209}},"version":"1\.1","request":{"method":"GET"}},"url":{"original":"\/favicon\.ico"},"timestamp":"26\/Dec\/2016:16:16:29 \+0200","source":{"ip":"192\.128\.0\.1"},"service":{"type":"apache"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"192\.128\.0\.1 - - \[26\/Dec\/2016:16:16:29 \+0200\] \\\\"POST \/favicon\.ico HTTP\/1\.1\\\\" 404 209","kind":"event","dataset":"apache\.access","category":\["web"\],"module":"apache","outcome":"failure"},"http":{"response":{"status_code":404,"body":{"bytes":209}},"version":"1\.1","request":{"method":"POST"}},"url":{"original":"\/favicon\.ico"},"timestamp":"26\/Dec\/2016:16:16:29 \+0200","source":{"ip":"192\.128\.0\.1"},"service":{"type":"apache"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,491 | INFO  | KahaDB is version 6 | org.apache.activemq.store.wawa.MessageDatabase | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,531 | INFO  | PListStore:[/opt/activemq/data/localhost/tmp_storage] started | org.apache.activemq.store.wawa.plist.PListStoreImpl | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,690 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is starting | org.apache.activemq.broker.BrokerService | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,712 | ERROR | Failed to start Apache ActiveMQ (localhost, ID:5323986a6080-37033-1572227374550-0:1) | org.apache.activemq.broker.BrokerService | main"}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,712 | ERROR | Failed to start Apache ActiveMQ (localhost, ID:5323986a6080-37033-1572227374550-0:1) | org.apache.activemq.broker.BrokerService | mainat org.apache.activemq.util.IOExceptionSupport.create(IOExceptionSupport.java:28)\[activemq-client-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.registerConnectorMBean(BrokerService.java:2264)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.startTransportConnector(BrokerService.java:2744)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.startAllConnectors(BrokerService.java:2640)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.doStartBroker(BrokerService.java:771)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.startBroker(BrokerService.java:733)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.broker.BrokerService.start(BrokerService.java:636)\[activemq-broker-5.15.9.jar:5.15.9\]at org.apache.activemq.xbean.XBeanBrokerService.afterPropertiesSet(XBeanBrokerService.java:73)\[activemq-spring-5.15.9.jar:5.15.9\]at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\[:1.8.0_212\]at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\[:1.8.0_212\]at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\[:1.8.0_212\]at java.lang.reflect.Method.invoke(Method.java:498)\[:1.8.0_212\]at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1763)\[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE\]at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1700)\[spring-beans-4.3.18.RELEASE.jar:4.3.18.RELEASE\]"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,716 | INFO  | Apache ActiveMQ 5.15.9 (localhost, ID:5323986a6080-37033-1572227374550-0:1) is shutting down | org.apache.activemq.broker.BrokerService | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,718 | INFO  | Connector openwire stopped | org.apache.activemq.broker.TransportConnector | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,719 | INFO  | Connector amqp stopped | org.apache.activemq.broker.TransportConnector | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,721 | INFO  | Connector stomp stopped | org.apache.activemq.broker.TransportConnector | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,722 | INFO  | Connector mqtt stopped | org.apache.activemq.broker.TransportConnector | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,723 | INFO  | Connector ws stopped | org.apache.activemq.broker.TransportConnector | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,727 | INFO  | PListStore:\[/opt/activemq/data/localhost/tmp_storage\] stopped | org.apache.activemq.store.wawa.plist.PListStoreImpl | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,728 | INFO  | Stopping async queue tasks | org.apache.activemq.store.kahaasddb.KahaDBStore | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-27 15:09:34,730 | INFO  | Stopping async topic tasks | org.apache.activemq.store.wawa.KahaDBStore | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-29 10:59:49,515 | INFO  | No Spring WebApplicationInitializer types detected on classpath | /admin | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"2019-11-29 10:59:49,779 | INFO  | Initializing Spring FrameworkServlet \'dispatcher\' | /admin | main"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"INFO  | anonymous called org.apache.activemq.broker.jmx.QueueView.retryMessages\[\] at 27-11-2019 08:45:57,213 | qtp443290224-47"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"INFO  | admin called org.apache.activemq.broker.jmx.QueueView.retryMessages\[\] at 27-11-2019 08:45:57,229 | qtp443290224-45"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"WARN  | admin requested /admin/createDestination.action \[JMSDestination=\'test\' JMSDestinationType=\'queue\' secret=\'4eb0bc3e-9d7a-4256-844c-24f40fda98f1\' \] from 127.0.0.1 | qtp12205619-39"}}"
      - r"{"wazuh":{"queue":49,"origin":"location"},"event":{"original":"INFO  | guest requested /admin/purgeDestination.action \[JMSDestination=\'test\' JMSDestinationType=\'queue\' secret=\'eff6a932-1b58-45da-a64a-1b30b246cfc9\' \] from 127.0.0.1 | qtp12205619-36"}}"
    