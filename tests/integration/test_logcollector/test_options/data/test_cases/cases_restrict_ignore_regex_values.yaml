- name: Test Restrict+Ignore - Matches Restrict
  description: Test Restrict + Ignore tags both with PCRE2 regex. Log matches restrict
  configuration_parameters:
    RESTRICT_REGEX: .*restrict
    IGNORE_REGEX: .*ignore
    RESTRICT_TYPE: PCRE2
    IGNORE_TYPE: PCRE2
  metadata:
    restrict_regex: .*restrict
    ignore_regex: .*ignore
    log_sample: "Nov 10 12:19:04 localhost sshd: log matches restrict"
    matches: restrict

- name: Test Restrict+Ignore - Matches Ignore Only
  description: Test Restrict + Ignore tags both with PCRE2 regex. Log matches ignore
  configuration_parameters:
    RESTRICT_REGEX: \.restrict
    IGNORE_REGEX: \.ignore
    RESTRICT_TYPE: osregex
    IGNORE_TYPE: osregex
  metadata:
    restrict_regex: \\.restrict
    ignore_regex: \\.ignore
    log_sample: "Nov 10 12:19:04 localhost sshd: log matches ignore"
    matches: ignore

- name: Test Restrict+Ignore - Matches Both
  description: Test Restrict + Ignore tags both with osmatch regex. Log matches both
  configuration_parameters:
    RESTRICT_REGEX: restrict$
    IGNORE_REGEX: ignore
    RESTRICT_TYPE: osmatch
    IGNORE_TYPE: osmatch
  metadata:
    restrict_regex: restrict\$
    ignore_regex: ignore
    log_sample: "Nov 10 12:19:04 localhost sshd: log matches ignore restrict"
    matches: ignore - restrict

- name: Test Restrict+Ignore - Matches None
  description: Test Restrict + Ignore tags (PCRE2+osregex) . Log matches None
  configuration_parameters:
    RESTRICT_REGEX: .*restrict
    IGNORE_REGEX: \.ignore
    RESTRICT_TYPE: PCRE2
    IGNORE_TYPE: osregex
  metadata:
    restrict_regex: .*restrict
    ignore_regex: \\.ignore
    log_sample: "Nov 10 12:19:04 localhost sshd: log does not match"
    matches: None
