import os
import pytest
from wazuh_testing.tools import file
from wazuh_testing.tools import configuration

test_data_path = os.path.join(os.path.dirname(os.path.realpath(__file__)), 'data')

test_cases_path = os.path.join(test_data_path, 'test_cases')
configurations_path = os.path.join(test_data_path, 'configuration_template')

# Configuration and cases data
test_content_cases_path = os.path.join(test_cases_path, 'cases_download_content.yaml')
configurations_path = os.path.join(configurations_path, 'configuration_custom_server.yaml')
configurations_path = os.path.join(configurations_path, 'configuration_online_server.yaml')


_, configuration_metadata, test_case_ids = configuration.get_test_cases_data(test_content_cases_path)

@pytest.mark.parametrize('metadata', configuration_metadata, ids=test_case_ids)
def test_update_content(metadata):

    """
    Check that the content is updated in the manager.
       Steps:
        1- Configure wazuh manager (fixture)
        2- Starts wazuh manager (fixture)
        3- Check that the module callback register the completion of the content update
        4- Check that the local DB is updated with the downloaded content
    """