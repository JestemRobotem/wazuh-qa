---
  - hosts: all
    vars_files:
      - ../../vars/main.yml
    tasks:
      - name: Creates directories to store agents' outputs in managers hosts
        file:
          path: "{{ item }}"
          state: directory
        with_items:
          - "{{ agents_results_manager_path }}"
          - "{{ agents_results_manager_path }}/create"
          - "{{ agents_results_manager_path }}/modify"
          - "{{ agents_results_manager_path }}/delete"
        when:
          - inventory_hostname in groups['masters']

      - block:
        - name: Create {{ agents_linux_output_path }} directory to store agents' outputs in agents hosts | Linux
          file:
            path: "{{ item }}"
            state: directory
          with_items:
            - "{{ agents_linux_output_path }}"
          when:
            - inventory_hostname in groups['linuxagents']
  
        - name: Create {{ agents_linux_output_path }} directory to store agents' outputs in agents hosts | Windows
          file:
            path: "{{ item }}"
            state: directory
          with_items:
            - "{{ agents_windows_output_path }}"
          when:
            - inventory_hostname in groups['windowsagents']
  
        - name: Copy {{ files_generated_output_path }} to the agents | Linux
          copy:
            src: "config/{{ files_generated_output_path }}"
            dest: "{{ agents_linux_output_path }}/" 
          when:
            - inventory_hostname in groups['linuxagents']
  
        - name: Copy {{ files_generated_output_path }} to the agents | Windows
          copy:
            src: "config/{{ files_generated_output_path }}"
            dest: "{{ agents_windows_output_path }}/" 
          when:
            - inventory_hostname in groups['windowsagents']
        when:
          - inventory_hostname in groups['linuxagents'] or inventory_hostname in groups['windowsagents'] 
  