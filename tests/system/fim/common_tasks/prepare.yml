- name: Creates directories to store agents' outputs in managers hosts
  file:
    path: "{{ item }}"
    state: directory
  with_items:
    - "{{ agents_results_manager_path }}"
    - "{{ agents_results_manager_path }}/create"
    - "{{ agents_results_manager_path }}/modify"
    - "{{ agents_results_manager_path }}/delete"
  when:
    - inventory_hostname in groups['masters']
  become: yes

- block:
  - name: Create {{ agents_linux_output_path }} directory to store Agents' outputs in Agents hosts | Linux
    file:
      path: "{{ agents_linux_output_path }}"
      state: directory
    when:
      - inventory_hostname in groups['linuxagents']
    become: yes      

  - name: Create {{ agents_windows_output_path }} directory to store agents' outputs in agents hosts | Windows
    win_file:
      path: "{{ agents_windows_output_path }}"
      state: directory
    when:
      - inventory_hostname in groups['windowsagents']

  - name: Copy {{ files_config_linux_source_path }} to the Agents hosts | Linux
    copy:
      src: "{{ files_config_linux_source_path }}"
      dest: "{{ files_config_linux_destination_path }}" 
    when:
      - inventory_hostname in groups['linuxagents']
    become: yes

  - name: Copy {{ files_config_windows_source_path }} to the Agents hosts | Windows
    win_copy:
      src: "{{ files_config_windows_source_path }}"
      dest: "{{ files_config_windows_destination_path }}" 
    when:
      - inventory_hostname in groups['windowsagents']
  when:
    - inventory_hostname in groups['linuxagents'] or inventory_hostname in groups['windowsagents']
