---
  - hosts: all
    vars_files:
      - ../../vars/main.yml
    tasks:
      - block:
        - name: Launching prepare tasks 
          import_tasks: "../../common_tasks/prepare.yml"

        - name: Configuring the files generation for Linux hosts
          set_fact:
            config_file: "{{ files_config_linux_destination_path }}"
            output_list: "{{ agents_linux_output_path }}"
          when:
            - inventory_hostname in groups["linuxagents"]

        - name: Configuring the files generation for Windows hosts
          set_fact:
            config_file: "{{ files_config_windows_destination_path }}"
            output_list: "{{ agents_windows_output_path }}"
          when:
            - inventory_hostname in groups["windowsagents"]

        - name: Generating files to trigger FIM alerts
          import_tasks: "../../common_tasks/create_files.yml"